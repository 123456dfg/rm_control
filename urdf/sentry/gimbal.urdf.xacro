<?xml version="1.0" encoding="utf-8"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

  <xacro:macro name="gimbal">

    <xacro:property name="threshold" value="0.1"/>
    <xacro:property name="pitch_lower_limit" value="0.192"/>
    <xacro:property name="pitch_upper_limit" value="0.872"/>

    <link name="yaw">
      <visual>
        <geometry>
          <mesh filename="package://rm_description/meshes/sentry/yaw.stl"
                scale="0.001 0.001 0.001"/>
        </geometry>
      </visual>
      <inertial>
        <mass value="0.225984"/>
        <origin xyz="0.00336 0 -0.0494" rpy="0 0 0"/>
        <inertia ixx="9.791e-4" ixy="6.37e-10" ixz="6.197e-5" iyy="1.507e-3"
                 iyz="1.806e-9" izz="7.527e-4"/>
      </inertial>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://rm_description/meshes/sentry/yaw.stl"
                scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <joint name="yaw_joint" type="continuous">
      <parent link="base_link"/>
      <child link="yaw"/>
      <axis xyz="0 0 1"/>
      <origin xyz="0.00 0.0 -0.21"/>
      <dynamics damping="0" friction="0.1"/>
      <limit effort="1.2" velocity="34" lower="-${2*pi}" upper="${2*pi}"/>
    </joint>


      <link name="pitch">
        <inertial>
          <mass value="1.155968"/>
          <origin xyz="0.019 -0.045 0.022"/>
          <inertia ixx="5.918e-3" ixy="1.6863e-6" ixz="2.4143e-6" iyy="2.048e-3"
                   iyz="-1.348e-4" izz="7.506e-3"/>
        </inertial>
        <visual>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://rm_description/meshes/sentry/pitch.stl" scale="0.001 0.001 0.001"/>
          </geometry>
        </visual>
        <collision>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://rm_description/meshes/sentry/pitch.stl" scale="0.001 0.001 0.001"/>
          </geometry>
        </collision>
      </link>

      <joint name="pitch_joint" type="revolute">
        <parent link="yaw"/>
        <child link="pitch"/>
        <axis xyz="1 0 0"/>
        <origin xyz="0 0 -0.1"/>
        <dynamics damping="0" friction="0.1"/>
        <limit effort="1.2" velocity="13.82" lower="${pitch_lower_limit}" upper="${pitch_upper_limit}"/>
        <!--        <safety_controller k_position="100" k_velocity="0.1"
                                   soft_lower_limit="${pitch_lower_limit+threshold}"
                                   soft_upper_limit="${pitch_upper_limit-threshold}"/>-->
      </joint>

  </xacro:macro>

</robot>